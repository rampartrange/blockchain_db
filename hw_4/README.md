## Apache SOLR - Search Engine

---

### **История развития**
   Apache Solr - это мощный и расширяемый поисковый сервер, построенный на базе Apache Lucene. Вот краткая история его
   развития:

1. **2004 год**: Apache Lucene был разработан Дугом Катцем и Майклом Маккафертом в 2004 году как библиотека для
   полнотекстового поиска в Java. Он предоставлял программистам API для индексации и поиска текстовых данных.

2. **2005 год**: По мере роста популярности Lucene, появилась потребность в инструментах для управления и
   обслуживания поисковых индексов. В ответ на это был создан проект Apache Solr в 2005 году как высокоуровневая
   обертка над Apache Lucene, предоставляющая HTTP API и множество дополнительных возможностей для работы с
   поисковыми индексами.

3. **2006 год**: Apache Solr стал проектом верхнего уровня Apache Software Foundation (ASF) в 2006 году, что
   подтвердило его статус как ведущего поискового сервера с открытым исходным кодом.

4. **2010-е годы**: В последующие годы Apache Solr продолжал развиваться и улучшаться. В 2010-х годах были выпущены
   несколько крупных версий с новыми возможностями и улучшениями производительности, такими как поддержка
   распределенного поиска, горизонтальное масштабирование, фасетный поиск и многое другое.

5. **Современность**: В настоящее время Apache Solr остается одним из самых популярных и мощных поисковых движков с
   открытым исходным кодом. Он широко используется в различных отраслях для создания поисковых приложений,
   индексации контента, анализа данных и других задач, требующих эффективного и гибкого поиска и аналитики.

   Таким образом, развитие Apache Solr от Apache Lucene до мощного поискового сервера с открытым исходным кодом отражает
   рост и важность поисковых технологий в современном мире информационных технологий.

### **Инструменты для взаимодействия с СУБД**

   Существует несколько инструментов и библиотек для взаимодействия с Apache Solr, которые предоставляют различные
   уровни абстракции и функциональные возможности. Вот некоторые из них:

1. Solr Admin UI - пользовательский интерфейс для управления и мониторинга индексов, выполнения запросов, настройки
   конфигурации и многого другого.
2. Apache Spark - существует библиотека `spark-solr`, которая обеспечивает интеграцию между Apache Spark и Apache
   Solr.
3. SolrJ - официальный Java клиент.
4. Существуют также неофициальные клиенты под такие языки программирования как: Python, Ruby, Php, Javascript и т.д.

### **Какой database engine используется в вашей СУБД?**
   Apache Solr - это не база данных в привычном понимании, а поисковый сервер, построенный на базе Apache Lucene.
   Lucene - это индексирующая библиотека, предназначенная для полнотекстового поиска и анализа текстовых данных. Solr
   предоставляет HTTP API и другие инструменты для управления и взаимодействия с данными, хранящимися и индексируемыми с
   использованием Lucene. 
   
Он обычно используется для создания поисковых приложений и индексации текстовых данных, а не
   для хранения и управления структурированными данными, как это делают базы данных.

### **Как устроен язык запросов в вашей СУБД? Разверните БД с данными и выполните ряд запросов**

   Apache Solr использует язык запросов: Solr Query Syntax (также известный как Solr Query DSL). Этот язык запросов
   предоставляет широкий набор функций и операторов для выполнения различных видов запросов к индексам Solr. Вот
   некоторые основные компоненты Solr Query Syntax:

* Простой поиск по ключевому слову: `q=keyword`
* Поиск по ключевому слову и фильтрация по категории: `q=keyword&fq=category:electronics`
* Поиск с использованием логических операторов: `q=(keyword1 AND keyword2) OR (keyword3 AND NOT keyword4)`
* Поиск по полю и диапазону значений: `q=title:computer&fq=price:[100 TO 200]`
* Поиск с использованием фраз: `q="exact phrase"`

### **Распределение файлов БД по разным носителям**

В Apache Solr данные хранятся в индексах, которые могут быть распределены по разным носителям с целью улучшения производительности и отказоустойчивости. Вот как работает распределение файлов в Apache Solr:
* **Шардинг (Sharding)**
* **Репликация (Replication)**
* **Директории индексов (Index Directories)**: В конфигурации Solr определяются директории, в которых хранятся индексы данных. Эти директории могут быть сконфигурированы для размещения на разных физических носителях.

### **На каком языке/ах программирования написана СУБД?**
   Java. Как и все продукты Apache.

### **Какие типы индексов поддерживаются в БД? Приведите пример создания индексов.**

1. **Text Index**
2. **Numeric Index**
3. **Date Index**
4. **Spatial Index** (для поиска по географическим данным)

Пример создания индекса в Apache Solr:

Создайте схему индексации (schema.xml), определив типы полей и их настройки:
```xml
<schema name="example" version="1.6">
  <fields>
    <field name="id" type="string" indexed="true" stored="true" required="true" />
    <field name="title" type="text_general" indexed="true" stored="true" />
    <field name="price" type="double" indexed="true" stored="true" />
    <field name="timestamp" type="tdate" indexed="true" stored="true" />
    <field name="location" type="location" indexed="true" stored="true" />
  </fields>
  <uniqueKey>id</uniqueKey>
</schema>
```

Загрузите схему индексации в Solr.
Добавьте данные в индекс.
Пример запроса для добавления документа в индекс с использованием HTTP API Solr:

```bash
curl http://localhost:8983/solr/example/update/json -d '
[
  {"id":"1", "title":"Product 1", "price":100.0, "timestamp":"2022-04-15T12:00:00Z", "location":"45.123,-78.456"}
]'
```

### **Как строится процесс выполнения запросов в SOLR?**

1. Получение запроса
2. Анализ запроса: Solr анализирует запрос и определяет его тип, включая поисковые условия, фильтры, сортировку и другие параметры.
3. Построение запроса внутреннего представления: Solr преобразует полученный запрос во внутреннее представление, которое используется для выполнения поискового запроса к индексу данных.
4. Оптимизация запроса
5. Исполнение запроса с помощью Apache Lucene: этот шаг включает поиск соответствующих документов в индексе и применение к ним всех заданных условий и фильтров.
6. Получение результатов
7. Отправка результатов клиенту

### **Поддерживаются ли транзакции в вашей СУБД? Если да, то расскажите о нем. Если нет, то существует ли альтернатива?**

Нет, SOLR не поддерживает транзакции в смысле ACID, как реляционные СУБД. Вместо этого Solr предлагает несколько альтернативных подходов для работы с данными и обеспечения целостности:

* Partial Updates
* Atomic Updates

### **Какие методы восстановления поддерживаются в вашей СУБД. Расскажите о них.**

1. **Резервное копирование и восстановление:**
  * `solr backup`: создает снимки индексов и других важных данных.
  * `solr restore`: восстанавливает данные из резервной копии.

2. **Репликация и отказоустойчивость**
3. **Snapshots**
4. **Self-healing**:

   Если в индексе обнаруживаются поврежденные сегменты, SOLR попытается восстановить их из других сегментов или реплик 

### **Расскажите про шардинг в вашей конкретной СУБД. Какие типы используются? Принцип работы.**

Принцип работы шардинга в Solr:

* Разделение данных: Исходный индекс данных разбивается на несколько фрагментов (шардов) на основе выбранного критерия разделения, например, на основе диапазона значений определенного поля (горизонтальное разделение) или на основе хэш-функции (случайное разделение).
* Распределение шардов: Каждый шард размещается на отдельном узле (Solr-сервере), что позволяет равномерно распределить нагрузку и обеспечить балансировку нагрузки между узлами.
* Маршрутизация запросов: При поступлении поискового запроса Solr определяет, к какому шарду должен быть направлен запрос на основе ключа (например, идентификатора документа или значения поля). Для этого используются хэш-функции или другие методы маршрутизации.
* Объединение результатов: После выполнения запроса результаты поиска с каждого шарда объединяются и возвращаются клиенту как единый набор результатов.

Еще у них есть классная фича - чтобы при увеличении количества шардов не пересчитывать все индексы, есть возможность сделать Shard Splitting: поделить один шард надвое: один останется как есть, а второй начнет использоваться далее

### **Возможно ли применить термины Data Mining, Data Warehousing и OLAP в вашей СУБД?**

1. Data Mining: Возможно производить агрегации и исследовать распределение данных
2. Data Warehousing: Нет
3. OLAP: Скорее нет, хотя можно создавать отчеты на основе агрегаций

### **Какие методы защиты поддерживаются вашей СУБД? Шифрование трафика, модели авторизации и т.п.**

1. SSL/TLS Encryption
2. Basic Authentication
3. Role-based access (authorization)
4. LDAP Integration
5. CORS

### **Какие сообщества развивают данную СУБД? Кто в проекте имеет права на коммит и создание дистрибутива версий? Расскажите об этих людей и/или компаниях.**

1. Apache
2. Open source

### **Где найти документацию и пройти обучение**

* [Обучение](https://solr.apache.org/guide/solr/latest/getting-started/solr-tutorial.html)
* [Документация](https://solr.apache.org/guide/solr/latest/index.html)

### **Как быть в курсе происходящего**
* [Новости](https://solr.apache.org/news.html)